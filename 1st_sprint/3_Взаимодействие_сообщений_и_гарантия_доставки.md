В этом уроке вы познакомитесь с разными способами взаимодействия данных, а также узнаете, что такое гарантия доставки, 
и какие варианты подобной доставки существуют.

## **Стили взаимодействия с помощью сообщений**
Существует несколько способов обмена сообщениями через брокеров, которые определяют, как данные передаются между системами. 
Вот основные паттерны:

**One-Way (Однонаправленная связь)**
Отправитель (Producer) просто отправляет сообщение, не ожидая ответа от получателя (Consumer). 
Это простой и быстрый способ передачи данных. 
Пример: сервисы отправляют логи в систему логирования, и она их обрабатывает без обратной связи.

**Request-Reply (Запрос-Ответ)**
Отправитель не только отправляет сообщение, но и ждёт ответа. 
Это похоже на диалог, где запрос обрабатывается, а затем возвращается результат. 
Пример: система бронирования авиабилетов отправляет запрос на поиск рейсов и получает ответ с результатами.

**Pub-Sub (Издатель-Подписчик)**
Сообщение от отправителя (Publisher) отправляется сразу нескольким получателям (Subscribers), которые подписаны на него. 
Это удобно, когда одно событие важно для разных сервисов. 
Пример: при покупке подписки в онлайн-кинотеатре сервисы авторизации, бухгалтерии и аналитики получают одно сообщение
и каждый обрабатывает его по-своему.

Эти паттерны помогают системам эффективно взаимодействовать в зависимости от задач.

## **Гарантии доставки сообщений**
Гарантии доставки сообщений — это важный аспект работы брокеров сообщений, которые обеспечивают, 
что данные дойдут до нужного адресата. Е

сть три основных типа таких гарантий:

1. At Most Once («Не более одного раза»): 
Сообщение отправляется только один раз, и если оно потеряется, его не отправят снова. Этот подход подходит для систем, 
где потеря нескольких сообщений не критична. 
Например, потеря одного клика на сайте среди миллионов.

2. At Least Once («Как минимум один раз»): 
Сообщение будет доставлено минимум один раз, но может быть отправлено повторно, если не получилось с первого раза. 
Это может привести к дублированию, и система должна быть готова к обработке повторяющихся сообщений.

3. Exactly Once («Ровно один раз»): 
Сообщение обрабатывается только один раз, даже если были попытки повторной доставки. 
Это самый сложный вариант для реализации, но необходим в ситуациях, где критически важно избежать дубликатов,
например, при выполнении платежей.

## **Очередь недоставленных сообщений (DeadLetterQueue)**
Это специальная очередь для сообщений, которые не удалось доставить или обработать. 
Вместо того чтобы терять такие сообщения, они помещаются в DLQ для последующего анализа и исправления.

Зачем нужна DLQ:

* Обработка ошибок: Если сообщение вызывает ошибку (например, из-за неправильного формата), оно попадает 
в DLQ для дальнейшего разбирательства.
* Отложенная обработка: Сообщения остаются в DLQ до тех пор, пока ошибка не будет исправлена, после чего их можно снова 
отправить на обработку.
* Мониторинг: Увеличение сообщений в DLQ помогает выявить проблемы в системе.
* Предотвращение потерь данных: Сообщения сохраняются для анализа и повторной отправки, если это необходимо.
Этот механизм помогает избежать потерь данных и даёт возможность обработать проблемные сообщения позже.

В этом уроке вы познакомились с разными способами взаимодействия данных, узнали, что такое гарантия доставки и зачем нужна DQL.
Все это необходимо для того, чтобы правильно настроить и использовать систему в зависимости от потребностей приложения.


## Квиз
**Вопрос 1:**

Какой стиль взаимодействия сообщений предполагает, что отправитель просто передаёт сообщение без ожидания ответа от получателя?

A) Request-Reply

B) One-Way

C) Pub-Sub

D) Two-Way Communication

Правильный ответ: B) One-Way

Пояснение: В однонаправленной связи (One-Way) отправитель передаёт сообщение и не ожидает ответа от получателя,
что делает этот способ простым и быстрым.


**Вопрос 2:** 

Какая гарантия доставки сообщений предполагает, что сообщение может быть доставлено несколько раз, но минимум один раз?

A) At Most Once

B) At Least Once

C) Exactly Once

D) Multiple Times

Правильный ответ: B) At Least Once

Пояснение: В модели "Как минимум один раз" (At Least Once) сообщение будет доставлено минимум один раз, 
но возможна его повторная отправка, что может привести к дубликатам.

**Вопрос 3:** 

Для чего используется DeadLetterQueue (DLQ)?

A) Для ускорения обработки сообщений

B) Для хранения сообщений, которые успешно обработаны

C) Для сообщений, которые не удалось доставить или обработать

D) Для удаления устаревших сообщений

Правильный ответ: C) Для сообщений, которые не удалось доставить или обработать

Пояснение: DLQ — это специальная очередь для сообщений, которые не удалось доставить или обработать, с целью их дальнейшего анализа и исправления.