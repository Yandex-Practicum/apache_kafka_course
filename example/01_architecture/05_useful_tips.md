# Полезные советы по проектированию архитектуры

![image](https://pictures.s3.yandex.net:443/resources/Untitled_Artwork_17_1618579797.png)

## На что смотреть при проектировании архитектуры

Архитектуры не появляются в вакууме. Обычно перед работой над ней появляется ТЗ, аналитика или, на худой конец, сырое описание задачи от человека из бизнеса. Основное внимание во всех случаях нужно уделять функциональным требованиям (какую ценность приносит система?) и нефункциональным требованиям (какие ограничения и ожидания есть для системы?). 

Часто люди забывают продумать граничные случаи при проектировании систем, что неминуемо ведёт к досадным промахам и даже утечкам персональной информации или потере денег компании. Поэтому обязательный инструмент архитектора — вопросы. Не нужно бояться задавать вопросы бизнесу, аналитикам, разработчикам, DevOps-инженерам и кому угодно. Это спасёт многие часы компании в будущем.

## Проблема выбора технологий и как с ней быть

Одна из острых проблем, с которой сталкивается архитектор, — выбор технологии для решения поставленной задачи. В небольших компаниях это выбор между существующими open-source-решениями или собственной разработкой. У компаний побольше ещё есть вариант купить дорогую «коробку». Из текущего многообразия технологий нужно выбирать те, которые выдержат проверку временем, будут рентабельны и соответствовать всем требованиям от бизнеса и разработки, что само по себе добавляет хлопот.

В такой ситуации опытные люди предлагают как можно дольше оттягивать выбор конкретных технологий так, чтобы максимально убрать неопределённость. По ходу сбора требований, прототипирования и общения со всеми заинтересованными сторонами можно лучше понять реальные потребности и закрыть их наиболее подходящими технологиями. Именно умение решать проблему выбора технологического стека делает архитекторов настолько ценными сотрудниками в компаниях.

На самом деле все графические отображения архитектуры нужны, чтобы все одинаково поняли, что нужно сделать. Остальные смыслы отрисовки архитектуры второстепенны.

## AS IS/TO BE

Следующий момент, который часто упускается, — отрисовка того, как должно быть, вместо указания текущей ситуации (AS IS) и желаемой ситуации (TO BE). 

Под ситуацией AS IS понимают текущую архитектуру. Это отображение позволяет понять, какие есть текущие ограничения систем, и проговорить их с заинтересованными сторонами до начала внесения изменений. 

После уточнения и фиксации изменений рисуется схема TO BE с указанием мест, где необходимо добавить или изменить архитектуру. Она позволяет чётко зафиксировать для всех сторон, какие конкретно изменения должны появиться при реализации поступивших требований.

## Ведение ADR (Architectural Decision Record)

С течением времени ключевые решения по архитектуре превращаются из «это и так всем известно» в «так исторически сложилось», что мешает развивать технические системы. Чтобы избежать этого, архитекторы придумали вести специальный лог принятых решений по архитектуре — Architectural Decision Record, или ADR.

Существует [достаточно много](https://github.com/joelparkerhenderson/architecture_decision_record){target="_blank"} вариантов написания ADR. Здесь рассмотрим вариант записей, который позволяет достичь трёх важных составляющих:

- записать непосредственно решение;
- указать контекст решения;
- указать рассмотренные альтернативы.

С самим решением всё понятно. Контекст нужен для понимания, в каких условиях принималось данное решение, чтобы впоследствии было легче его менять. Альтернативы позволяют понять, что решение взято не с потолка, а выбрано среди нескольких вариантов, которые в заданном контексте не подошли.

Пример ADR:

![image](https://pictures.s3.yandex.net:443/resources/Useful_Architecture_Tips_1_1631782197.png)

Такие записи позволяют не спорить по поводу принятых решений в будущем, а сосредотачиваться на том, чтобы менять решения при изменении контекста задачи или добавлении новых альтернатив.

## Agile и архитектура

Часто возникает вопрос: стоит ли проектировать архитектуру при Agile-подходе? На самом деле архитектура проектируется всегда, чаще всего неявно. Принимаются решения о языке программирования, фреймворках, базах данных, способах коммуникации. Даже когда пишется MVP для проверки гипотезы, его всё равно проектируют, но «на коленке». Поэтому в Agile архитектура тоже проектируется, а сам процесс проектирования вбирает в себя разные инструменты Agile-подхода, например итеративное проектирование.

## Полезные ссылки

- [Если вам нужно разрабатывать сложную большую систему](https://www.ozon.ru/product/shablony-korporativnyh-prilozheniy-147417586){target="_blank"}
- [Если нужно разобраться с базовыми принципами построения архитектур](https://www.ozon.ru/product/chistaya-arhitektura-iskusstvo-razrabotki-programmnogo-obespecheniya-144499396){target="_blank"}
- [Для тех, кто хочет разложить по полочкам инструментарий архитектора](https://www.amazon.com/Design-Programmer-Architect-Pragmatic-Programmers/dp/1680502093){target="_blank"}
